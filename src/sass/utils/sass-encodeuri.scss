@charset "utf-8";

// ascii码 与 16进制对照表
$asciiHexMap: ("	": "%09",
" ": "%20",
"\"": "%22",
"%": "%25",
"/": "%2f",
"<": "%3c",
">": "%3e",
"\\": "%5c",
"^": "%5e",
"`": "%60",
"{": "%7b",
"|": "%7c",
"}": "%7d"
);

@function gethexcode($ascii) {
  $n: '';

  @if ($n==$ascii) {
    // 换行
    $ascii: ""; // 当成空格
  }

  $hex: map-get($asciiHexMap, $ascii);

  @if (null==$hex) {
    $hex: $ascii; // 表示是 0~9, a~z, A~Z, -. 原样返回
  }

  @return $hex;
}

@function insertxmlns($svg, $fill) {
  // 检查是否存在 xmlns，如果没有就插上去
  $xmlns: 'xmlns="http://www.w3.org/2000/svg"';
  $xmlns2: "xmlns='http://www.w3.org/2000/svg'";
  $insertPos: str_index($svg, "<svg"); // 如果是 null，应该要报错了
  @debug $svg;
  @debug $insertPos;
  @if (null==str_index($svg, $xmlns) and null==str_index($svg, $xmlns2) and null !=$insertPos) {
    // 需要插入 xmlns
    $svg: str_insert($svg, " "+$xmlns, $insertPos + 4);
  }

  @return $svg;
}

@function svg-color-string-modifier($svg-color: false) {
  // 1. Checking if an argument has been passed in     
  @if($svg-color != false) {
      // 2. Adding quotes around Hex value so its actually a string
      $svg-color-str: quote(#{$svg-color}); 
      
      // 3. If the color has a "#" at the start it will be removed from the string
      $svg-color: str-replace($svg-color-str, "#", "");
      
      // 4. Returns SVG as a string with the new fill value dynamically inserted         
      @return "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' fill='%23#{$svg-color}' %3E%3Cpath d='M100 0a100 100 0 1 0 100 100A100.1 100.1 0 0 0 100 0zm43.88 123.93a5.58 5.58 0 1 1-5.58 5.59 5.58 5.58 0 0 1 5.58-5.59zm-87.75 0a5.58 5.58 0 1 1-5.57 5.59 5.58 5.58 0 0 1 5.57-5.59zM36.62 170a94.4 94.4 0 0 1-21-112.48C29.78 75 47.87 110.25 36.58 170zm63.43 24.5a94 94 0 0 1-51.07-15c10.09-14.27 46.69-75 13.29-166.15a94.42 94.42 0 0 1 75.57 0c-33.4 91.13 3.19 151.88 13.28 166.15a94 94 0 0 1-51.11 15zm63.43-24.5c-11.33-59.77 6.73-95 21-112.48a94.38 94.38 0 0 1-21 112.47zm-39.7 6.64l-1.72-13.82a4.12 4.12 0 0 0-3.08-3.51l-17.91-4.82a4.43 4.43 0 0 0-2.17 0L81 159.33a4.16 4.16 0 0 0-3.08 3.51l-1.72 13.82a4.22 4.22 0 0 0 .41 2.4c.71 1.39 5.14 8.22 23.35 8.31s22.6-6.92 23.34-8.31a4.09 4.09 0 0 0 .48-2.4z'/%3E%3C/svg%3E";
  }
}

// 将svg字符串转换成 URL 编码
@function encodeURI ($svg: '', $fill: 'red') {
  $svg: insertxmlns($svg, $fill);
  $url: 'data:image/svg+xml;charset=utf-8,';
  $str_len: str_length($svg);

  @for $i from 1 through $str_len {
    $url: $url + gethexcode(str_slice($svg, $i, $i));
  }

  @return $url;
}
